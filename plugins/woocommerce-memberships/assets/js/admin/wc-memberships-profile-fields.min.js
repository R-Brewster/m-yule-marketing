"use strict";jQuery(document).ready(function(n){var a,i,l,s=null!==window.wc_memberships_admin?window.wc_memberships_admin:{};"admin_page_wc_memberships_profile_fields"===(null!==window.pagenow?window.pagenow:"")&&(a=function(){n("#profile-field-options").sortable({axis:"y",handle:n(".wc-memberships-profile-field-sort-handle"),update:function(){n(".profile-field-option-row").not("#profile-field-option--template").each(function(e,i){var t=e;n(i).find("input").each(function(e,i){n(i).hasClass("multi-default-field")?(n(i).attr("name","default_options["+t+"]"),n(i).attr("value",t)):n(i).hasClass("default-field")?n(i).attr("value",t):n(i).hasClass("name-field")&&n(i).attr("name","options["+t+"]")})})}})},i=function(){var e=n("#visibility").val(),i="customer"===n('input[name="editable_by"]:checked').val(),t=e&&1===e.length&&"profile-fields-area"===e[0];i&&!t?n("#required").closest("p").show():n("#required").closest("p").hide()},n("#the-list").sortable({axis:"y",handle:n(".wc-memberships-profile-field-sort-handle").not(".disabled"),update:function(){var e=n(".table-view-list "),i=[];e.block({message:null,overlayCSS:{opacity:.6}}),e.find('input[name="bulk_action[]"]').each(function(){i.push(n(this).val())}),n.post(s.ajax_url,{action:"wc_memberships_sort_profile_fields",security:s.sort_profile_fields_nonce,profile_fields:i},function(){}).always(function(){e.unblock()})}}),n(".wc-memberships-profile-field-switch > input").on("click change",function(e){e.preventDefault();var i,o=n(this),l=o.is(":checked");"editable_by"===n(this).data("prop")&&n(this).data("profile-field").length&&(i={action:"wc_memberships_toggle_profile_field_editable_by",security:s.toggle_profile_field_editable_by_nonce,profile_field:n(this).data("profile-field")},n.post(s.ajax_url,i,function(e){var t;e&&e.success?(t=o.closest("tr").find("td.visibility"),o.prop("checked","customer"===e.data.editable_by),t.html(""),0===e.data.visibility.length?t.append("<span>&mdash;</span>"):n(e.data.visibility).each(function(e,i){t.append("<span>"+s.profile_fields_visibility_options[i]+"</span>")})):(o.prop("checked",l),console.log(e))}))}),n(".handlediv").on("click",function(e){e.preventDefault();var i=n(this).closest(".postbox");i.toggleClass("closed"),n(this).attr("aria-expanded",i.hasClass("closed")?"false":"true")}),n("ul.wc-tabs > li a").on("click",function(e){if(e.preventDefault(),n(e.target).closest("li").hasClass("disabled"))return!1;var i=n(e.target).closest("li"),t=n(n(e.target).attr("href"));n(".panel").hide(),t.show(),n(".wc-tab").removeClass("active"),i.addClass("active")}).first().trigger("click"),n("#type").on("change",function(e){var i=n(this).val();"checkbox"!==i?n('input[name="default_value"]').closest("p").hide():n('input[name="default_value"]').closest("p").show(),-1!==n.inArray(i,["select","radio","multiselect","multicheckbox"])?n(".field_options_tab").removeClass("disabled"):n(".field_options_tab").addClass("disabled"),-1!==n.inArray(i,["multiselect","multicheckbox"])?(n('.profile-field-option-default > input[type="radio"]').hide(),n('.profile-field-option-default > input[type="checkbox"]').show()):(n('.profile-field-option-default > input[type="radio"]').show(),n('.profile-field-option-default > input[type="checkbox"]').hide())}).trigger("change"),n("#visibility").on("change",function(e){i()}).trigger("change"),n('input[name="editable_by"]').on("change",function(e){"admin"===n(this).attr("value")&&n(this).is(":checked")?n("#label, #description, #visibility").closest("p").hide():"customer"===n(this).attr("value")&&n(this).is(":checked")&&n("#label, #description, #visibility").closest("p").show(),i()}).trigger("change"),n("button.add-profile-field-option").on("click",function(e){var i,t=n("#profile-field-option--template"),o=n(".profile-field-option-row:not(#profile-field-option--template)").length,l=t.clone().attr("id","");l.find(".profile-field-option-field").each(function(e,i){n(i).attr("name",n(i).attr("name").replace("template",o)),"default_option"===n(i).attr("name")&&n(i).attr("value",o)}),l.appendTo(t.closest("tbody")),n(".profile-field-no-options").hide(),n(".remove-profile-field-options").show(),(i=n("#profile-field-options")).sortable("destroy"),i.find("li").removeClass("ui-state-default"),i.find("li span").remove(),a()}),n("button.remove-profile-field-options").on("click",function(e){n(".profile-field-option-row th.check-column input:checked").closest(".profile-field-option-row").remove(),0===n(".profile-field-option-row").not("#profile-field-option--template").length?(n(".profile-field-no-options").show(),n(".remove-profile-field-options").hide()):(n(".profile-field-no-options").hide(),n(".remove-profile-field-options").show())}),a(),l=!1,n("#mainform").on("submit",function(e){if(n("#filter_action").length)return!0;var i,t,o;l||(e.preventDefault(),i=n("#title"),t=n("#visibility"),""===i.val().trim()?(n(".show-if-no-name").show(),i.fadeOut(150).fadeIn(150).fadeOut(150).fadeIn(150).fadeOut(150).fadeIn(150)):"customer"!==n('input[name="editable_by"]:checked').val()||t.val()&&0!==t.val().length?-1!==n.inArray(n("#type").val(),["select","radio","multiselect","multicheckbox"])?"table-row"===(o=n(".profile-field-no-options")).css("display")?(n(".show-if-options-required").show(),n(".show-if-options-empty").hide(),n(".field_options_tab > a").trigger("click"),o.fadeOut(150).fadeIn(150).fadeOut(150).fadeIn(150).fadeOut(150).fadeIn(150)):(l=!0,n(".profile-field-option-row").not("#profile-field-option--template").find(".name-field").each(function(e,i){if(""===n(i).val().trim())return n(".show-if-options-required").hide(),n(".show-if-options-empty").show(),n(".field_options_tab > a").trigger("click"),n(i).fadeOut(150).fadeIn(150).fadeOut(150).fadeIn(150).fadeOut(150).fadeIn(150),l=!1})):l=!0:(0===n(".show-if-no-visibility").length&&n("p.visibility_field").append('<span class="description show-if-no-visibility profile-field-validation-error" style="display:block;clear:both;">'+s.i18n.profile_field_no_visibility+" </span>"),t.closest("p").fadeOut(150).fadeIn(150).fadeOut(150).fadeIn(150).fadeOut(150).fadeIn(150)),l&&n("#mainform").trigger("submit"))}),window.WC_Memberships_Modal_View_Profile_Fields_Confirm_Deletion=WC_Memberships_Modal_View.extend({template_id:"wc-memberships-modal-confirm-profile-field-deletion",initialize:function(e){var i=this;WC_Memberships_Modal_View_Profile_Fields_Confirm_Deletion.__super__.initialize.apply(this,arguments),n("#wc-memberships-modal-confirm-profile-field-deletion").on("click","#btn-hide",function(e){return i.hideButton(e)}).on("click","#btn-delete",function(e){return i.deleteButton(e)}).on("click","#btn-cancel",function(){return i.close()})},hideButton:function(e){e.preventDefault(),n('input[name="editable_by"][value="admin"]').prop("checked",!0).trigger("change"),n('select[name="visibility[]"]').val(null).trigger("change"),n("#mainform").trigger("submit")},deleteButton:function(e){e.preventDefault(),document.location.href=n("#delete-action .submitdelete").attr("href")}}),s.profile_field_is_in_use&&n("#delete-action .submitdelete").on("click.memberships",function(e){e.preventDefault(),new window.WC_Memberships_Modal_View_Profile_Fields_Confirm_Deletion}))});